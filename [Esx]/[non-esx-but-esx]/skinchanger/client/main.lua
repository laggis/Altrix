PedList = {
  'a_f_m_bevhills_01',
	'a_f_m_fatbla_01',
	'a_f_m_fatwhite_01',
	'a_f_m_soucentmc_01',
	'a_f_m_soucent_01',
	'a_f_m_soucent_02',
	'a_f_m_tourist_01',
	'a_f_m_prolhost_01',
	'a_f_m_skidrow_01',
	'a_f_o_indian_01',
	'a_f_y_bevhills_01',
	'a_f_y_bevhills_02',
	'a_f_y_bevhills_03',
	'a_f_y_bevhills_04',
	'a_f_y_business_01',
	'a_f_y_business_02',
	'a_f_y_business_03',
	'a_f_y_business_04',
	'a_f_y_eastsa_01',
	'a_f_y_eastsa_02',
	'a_f_y_eastsa_03',
	'a_f_y_epsilon_01',
	'a_f_y_fitness_01',
	'a_f_y_fitness_02',
	'a_f_y_genhot_01',
	'a_f_y_golfer_01',
	'a_f_y_hiker_01',
	'a_f_y_hippie_01',
	'a_f_y_hipster_01',
	'a_f_y_hipster_02',
	'a_f_y_hipster_03',
	'a_f_y_hipster_04',
	'a_f_y_indian_01',
	'a_f_y_juggalo_01',
	'a_f_y_runner_01',
	'a_f_y_rurmeth_01',
	'a_f_y_scdressy_01',
	'a_f_y_skater_01',
	'a_f_y_soucent_01',
	'a_f_y_soucent_02',
	'a_f_y_soucent_03',
	'a_f_y_tennis_01',
	'a_f_y_tourist_01',
	'a_f_y_tourist_02',
	'a_f_y_vinewood_01',
	'a_f_y_vinewood_02',
	'a_f_y_vinewood_03',
	'a_f_y_vinewood_04',
	'a_f_y_yoga_01',
	'a_m_m_afriamer_01',
	'a_m_m_beach_01',
	'a_m_m_bevhills_01',
	'a_m_m_bevhills_02',
	'a_m_m_business_01',
	'a_m_m_eastsa_01',
	'a_m_m_eastsa_02',
	'a_m_m_farmer_01',
	'a_m_m_fatlatin_01',
	'a_m_m_genfat_01',
	'a_m_m_genfat_02',
	'a_m_m_golfer_01',
	'a_m_m_hasjew_01',
	'a_m_m_hillbilly_01',
	'a_m_m_hillbilly_02',
	'a_m_m_indian_01',
	'a_m_m_ktown_01',
	'a_m_m_malibu_01',
	'a_m_m_mexcntry_01',
	'a_m_m_mexlabor_01',
	'a_m_m_og_boss_01',
	'a_m_m_paparazzi_01',
	'a_m_m_polynesian_01',
	'a_m_m_prolhost_01',
	'a_m_m_rurmeth_01',
	'a_m_m_salton_01',
	'a_m_m_salton_02',
	'a_m_m_salton_03',
	'a_m_m_salton_03',
	'a_m_m_skater_01',
	'a_m_m_skidrow_01',
	'a_m_m_socenlat_01',
	'a_m_m_soucent_01',
	'a_m_m_soucent_02',
	'a_m_m_soucent_03',
	'a_m_m_soucent_04',
	'a_m_m_stlat_02',
	'a_m_m_tennis_01',
	'a_m_m_tourist_01',
	'a_m_m_trampbeac_01',
	'a_m_m_tramp_01',
	'a_m_m_tramp_01',
	'a_m_o_acult_02',
	'a_m_o_beach_01',
	'a_m_o_genstreet_01',
	'a_m_o_ktown_01',
	'a_m_o_salton_01',
	'a_m_o_soucent_01',
	'a_m_o_soucent_02',
	'a_m_o_soucent_03',
	'a_m_o_tramp_01',
	'a_m_y_beachvesp_01',
	'a_m_y_beachvesp_02',
	'a_m_y_beach_01',
	'a_m_y_beach_02',
	'a_m_y_beach_03',
	'a_m_y_bevhills_01',
	'a_m_y_bevhills_02',
	'a_m_y_breakdance_01',
	'a_m_y_busicas_01',
	'a_m_y_business_01',
	'a_m_y_business_02',
	'a_m_y_business_03',
	'a_m_y_cyclist_01',
	'a_m_y_dhill_01',
	'a_m_y_downtown_01',
	'a_m_y_eastsa_01',
	'a_m_y_eastsa_02',
	'a_m_y_epsilon_01',
	'a_m_y_epsilon_02',
	'a_m_y_gay_01',
	'a_m_y_gay_02',
	'a_m_y_genstreet_01',
	'a_m_y_genstreet_02',
	'a_m_y_golfer_01',
	'a_m_y_hasjew_01',
	'a_m_y_hiker_01',
	'a_m_y_hippy_01',
	'a_m_y_hipster_01',
	'a_m_y_hipster_02',
	'a_m_y_hipster_03',
	'a_m_y_indian_01',
	'a_m_y_jetski_01',
	'a_m_y_juggalo_01',
	'a_m_y_ktown_01',
	'a_m_y_ktown_02',
	'a_m_y_latino_01',
	'a_m_y_methhead_01',
	'a_m_y_mexthug_01',
	'a_m_y_motox_01',
	'a_m_y_motox_02',
	'a_m_y_musclbeac_02',
	'a_m_y_polynesian_01',
	'a_m_y_roadcyc_01',
	'a_m_y_runner_01',
	'a_m_y_runner_02',
	'a_m_y_salton_01',
	'a_m_y_skater_01',
	'a_m_y_skater_02',
	'a_m_y_soucent_01',
	'a_m_y_soucent_02',
	'a_m_y_soucent_03',
	'a_m_y_soucent_04',
	'a_m_y_stbla_01',
	'a_m_y_stbla_02',
	'a_m_y_stlat_01',
	'a_m_y_stwhi_01',
	'a_m_y_stwhi_02',
	'a_m_y_sunbathe_01',
	'a_m_y_vindouche_01',
	'a_m_y_vinewood_01',
	'a_m_y_vinewood_02',
	'a_m_y_vinewood_03',
	'a_m_y_vinewood_04',
	'a_m_y_yoga_01',
	'csb_abigail',
	'csb_anita',
	'csb_anton',
	'csb_ballasog',
	'csb_car3guy1',
	'csb_car3guy2',
	'csb_chin_goon',
	'csb_cletus',
	'csb_customer',
	'csb_denise_friend',
	'csb_fos_rep',
	'csb_groom',
	'csb_grove_str_dlr',
	'csb_g',
	'csb_hao',
	'csb_hugh',
	'csb_imran',
	'csb_janitor',
	'csb_ortega',
	'csb_oscar',
	'csb_porndudes',
	'csb_prologuedriver',
	'csb_ramp_gang',
	'csb_ramp_hic',
	'csb_ramp_hipster',
	'csb_ramp_mex',
	'csb_reporter',
	'csb_roccopelosi',
	'csb_screen_writer',
	'csb_stripper_01',
	'csb_tonya',
	'g_f_y_ballas_01',
	'g_f_y_families_01',
	'g_f_y_families_01',
	'g_f_y_vagos_01',
	'g_m_m_armboss_01',
	'g_m_m_armgoon_01',
	'g_m_m_armlieut_01',
	'g_m_m_chiboss_01',
	'g_m_m_chicold_01',
	'g_m_m_chigoon_01',
	'g_m_m_chigoon_02',
	'g_m_m_korboss_01',
	'g_m_m_mexboss_01',
	'g_m_m_mexboss_02',
	'g_m_y_armgoon_02',
	'g_m_y_azteca_01',
	'g_m_y_ballaeast_01',
	'g_m_y_ballaorig_01',
	'g_m_y_ballasout_01',
	'g_m_y_famca_01',
	'g_m_y_famdnf_01',
	'g_m_y_famfor_01',
	'g_m_y_korean_01',
	'g_m_y_korean_02',
	'g_m_y_korlieut_01',
	'g_m_y_lost_01',
	'g_m_y_lost_02',
	'g_m_y_lost_03',
	'g_m_y_mexgang_01',
	'g_m_y_mexgoon_01',
	'g_m_y_mexgoon_02',
	'g_m_y_mexgoon_03',
	'g_m_y_pologoon_01',
	'g_m_y_pologoon_02',
	'g_m_y_salvaboss_01',
	'g_m_y_salvagoon_01',
	'g_m_y_salvagoon_02',
	'g_m_y_salvagoon_03',
	'g_m_y_strpunk_01',
	'g_m_y_strpunk_02',
	'ig_abigail',
	'ig_ashley',
	'ig_bankman',
	'ig_barry',
	'ig_bestmen',
	'ig_beverly',
	'ig_car3guy1',
	'ig_car3guy2',
	'ig_chengsr',
	'ig_claypain',
	'ig_clay',
	'ig_cletus',
	'ig_dale',
	'ig_dreyfuss',
	'ig_hao',
	'ig_hunter',
	'ig_jewelass',
	'ig_jimmyboston',
	'ig_joeminuteman',
	'ig_josef',
	'ig_josh',
	'ig_kerrymcintosh',
	'ig_lifeinvad_01',
	'ig_lifeinvad_02',
	'ig_magenta',
	'ig_manuel',
	'ig_marnie',
	'ig_maryann',
	'ig_natalia',
	'ig_nigel',
	'ig_old_man1a',
	'ig_old_man2',
	'ig_oneil',
	'ig_paper',
	'ig_priest',
	'ig_ramp_gang',
	'ig_roccopelosi',
	's_f_y_bartender_01',
	's_f_y_hooker_01',
	's_f_y_hooker_02',
	's_f_y_hooker_03',
	's_f_y_shop_low',
	's_f_y_shop_mid',
	's_m_m_autoshop_01',
	's_m_m_autoshop_02',
	's_m_m_bouncer_01',
	's_m_m_hairdress_01',
	's_m_m_highsec_01',
	's_m_m_highsec_02',
	's_m_m_lifeinvad_01',
	's_m_m_mariachi_01',
	's_m_m_movprem_01',
	's_m_m_trucker_01',
	's_m_o_busker_01',
	's_m_y_barman_01',
	's_m_y_dealer_01',
	's_m_y_devinsec_01',
	's_m_y_robber_01',
	's_m_y_strvend_01',
	's_m_y_shop_mask',
	's_m_y_valet_01',
	's_m_y_winclean_01',
	's_m_y_xmech_01',
	's_m_y_xmech_02',
	'u_f_m_miranda',
	'u_f_y_bikerchic',
	'u_f_y_comjane',
	'u_f_y_hotposh_01',
	'u_f_y_jewelass_01',
	'u_f_y_mistress',
	'u_f_y_poppymich',
	'u_m_m_aldinapoli',
	'u_m_m_filmdirector',
	'u_m_m_griff_01',
	'u_m_m_jesus_01',
	'u_m_m_partytarget',
	'u_m_m_promourn_01',
	'u_m_m_rivalpap',
	'u_m_m_spyactor',
	'u_m_m_willyfist',
	'u_m_o_finguru_01',
	'u_m_o_taphillbilly',
	'u_m_o_tramp_01',
	'u_m_y_antonb',
	'u_m_y_cyclist_01',
	'u_m_y_fibmugger_01',
	'u_m_y_guido_01',
	'u_m_y_gunvend_01',
	'u_m_y_hippie_01',
	'u_m_y_mani',
	'u_m_y_militarybum',
	'u_m_y_paparazzi',
	'u_m_y_party_01',
	'u_m_y_proldriver_01',
	'u_m_y_sbike',
	'u_m_y_tattoo_01',
	'a_c_cat_01'
}

local Components = {
  {label = "Karaktär",                   name = 'sex',           value = 0,  min = 0,  zoomOffset = 0.6,   camOffset = 0.65}, --
  {label = _U('face'),                  name = 'face',          value = 0,  min = 0,  zoomOffset = 0.6,   camOffset = 0.65}, --
  {label = _U('skin'),                  name = 'skin',          value = 0,  min = 0,  zoomOffset = 0.6,   camOffset = 0.65}, --
  {label = _U('wrinkles'),              name = 'age_1',         value = 0,  min = 0,  zoomOffset = 0.4,   camOffset = 0.65}, --
  {label = _U('wrinkle_thickness'),     name = 'age_2',         value = 0,  min = 0,  zoomOffset = 0.4,   camOffset = 0.65}, --
  {label = _U('beard_type'),            name = 'beard_1',       value = 0,  min = 0,  zoomOffset = 0.4,   camOffset = 0.65}, --
  {label = _U('beard_size'),            name = 'beard_2',       value = 0,  min = 0,  zoomOffset = 0.4,   camOffset = 0.65}, --
  {label = _U('beard_color_1'),         name = 'beard_3',       value = 0,  min = 0,  zoomOffset = 0.4,   camOffset = 0.65}, --
  {label = _U('beard_color_2'),         name = 'beard_4',       value = 0,  min = 0,  zoomOffset = 0.4,   camOffset = 0.65}, --
  {label = _U('hair_1'),                name = 'hair_1',        value = 0,  min = 0,  zoomOffset = 0.6,   camOffset = 0.65}, --
  {label = _U('hair_2'),                name = 'hair_2',        value = 0,  min = 0,  zoomOffset = 0.6,   camOffset = 0.65}, --
  {label = _U('hair_color_1'),          name = 'hair_color_1',  value = 0,  min = 0,  zoomOffset = 0.6,   camOffset = 0.65}, --
	{label = _U('hair_color_2'),          name = 'hair_color_2',  value = 0,  min = 0,  zoomOffset = 0.6,   camOffset = 0.65}, --
	{label = 'Ögonfärg',                  name = 'eye_color',     value = 0,  min = 0,  zoomOffset = 0.6,   camOffset = 0.65},
  {label = _U('eyebrow_size'),          name = 'eyebrows_2',    value = 0,  min = 0,  zoomOffset = 0.4,   camOffset = 0.65}, --
  {label = _U('eyebrow_type'),          name = 'eyebrows_1',    value = 0,  min = 0,  zoomOffset = 0.4,   camOffset = 0.65}, --
  {label = _U('eyebrow_color_1'),       name = 'eyebrows_3',    value = 0,  min = 0,  zoomOffset = 0.4,   camOffset = 0.65}, --
  {label = _U('eyebrow_color_2'),       name = 'eyebrows_4',    value = 0,  min = 0,  zoomOffset = 0.4,   camOffset = 0.65}, --
  {label = _U('makeup_type'),           name = 'makeup_1',      value = 0,  min = 0,  zoomOffset = 0.4,   camOffset = 0.65}, --
  {label = _U('makeup_thickness'),      name = 'makeup_2',      value = 0,  min = 0,  zoomOffset = 0.4,   camOffset = 0.65}, --
  {label = _U('makeup_color_1'),        name = 'makeup_3',      value = 0,  min = 0,  zoomOffset = 0.4,   camOffset = 0.65}, --
  {label = _U('makeup_color_2'),        name = 'makeup_4',      value = 0,  min = 0,  zoomOffset = 0.4,   camOffset = 0.65}, --
  {label = _U('lipstick_type'),         name = 'lipstick_1',    value = 0,  min = 0,  zoomOffset = 0.4,   camOffset = 0.65}, --
  {label = _U('lipstick_thickness'),    name = 'lipstick_2',    value = 0,  min = 0,  zoomOffset = 0.4,   camOffset = 0.65}, --
  {label = _U('lipstick_color_1'),      name = 'lipstick_3',    value = 0,  min = 0,  zoomOffset = 0.4,   camOffset = 0.65}, --
  {label = _U('lipstick_color_2'),      name = 'lipstick_4',    value = 0,  min = 0,  zoomOffset = 0.4,   camOffset = 0.65}, --
  {label = _U('ear_accessories'),       name = 'ears_1',        value = -1, min = -1, zoomOffset = 0.4,   camOffset = 0.65}, --
  {label = _U('ear_accessories_color'), name = 'ears_2',        value = 0,  min = 0,  zoomOffset = 0.4,   camOffset = 0.65, textureof = 'ears_1'}, --
  {label = _U('tshirt_1'),              name = 'tshirt_1',      value = 0,  min = 0,  zoomOffset = 0.7,  camOffset = 0.15}, --
  {label = _U('tshirt_2'),              name = 'tshirt_2',      value = 0,  min = 0,  zoomOffset = 0.7,  camOffset = 0.15, textureof = 'tshirt_1'}, --
  {label = _U('torso_1'),               name = 'torso_1',       value = 0,  min = 0,  zoomOffset = 0.7,  camOffset = 0.15}, --
  {label = _U('torso_2'),               name = 'torso_2',       value = 0,  min = 0,  zoomOffset = 0.7,  camOffset = 0.15, textureof = 'torso_1'}, --
  {label = _U('decals_1'),              name = 'decals_1',      value = 0,  min = 0,  zoomOffset = 0.7,  camOffset = 0.15}, --
  {label = _U('decals_2'),              name = 'decals_2',      value = 0,  min = 0,  zoomOffset = 0.7,  camOffset = 0.15, textureof = 'decals_1'}, --
  {label = _U('arms'),                  name = 'arms',          value = 0,  min = 0,  zoomOffset = 0.7,  camOffset = 0.15}, --
  {label = _U('pants_1'),               name = 'pants_1',       value = 0,  min = 0,  zoomOffset = 0.8,   camOffset = -0.5}, --
  {label = _U('pants_2'),               name = 'pants_2',       value = 0,  min = 0,  zoomOffset = 0.8,   camOffset = -0.5, textureof = 'pants_1'}, --
  {label = _U('shoes_1'),               name = 'shoes_1',       value = 0,  min = 0,  zoomOffset = 0.8,   camOffset = -0.8},
  {label = _U('shoes_2'),               name = 'shoes_2',       value = 0,  min = 0,  zoomOffset = 0.8,   camOffset = -0.8, textureof = 'shoes_1'},
  {label = _U('mask_1'),                name = 'mask_1',        value = 0,  min = 0,  zoomOffset = 0.6,   camOffset = 0.65}, --
  {label = _U('mask_2'),                name = 'mask_2',        value = 0,  min = 0,  zoomOffset = 0.6,   camOffset = 0.65, textureof = 'mask_1'}, --
  {label = _U('bproof_1'),              name = 'bproof_1',      value = 0,  min = 0,  zoomOffset = 0.7,  camOffset = 0.15}, --
  {label = _U('bproof_2'),              name = 'bproof_2',      value = 0,  min = 0,  zoomOffset = 0.7,  camOffset = 0.15, textureof = 'bproof_1'}, --
  {label = _U('chain_1'),               name = 'chain_1',       value = 0,  min = 0,  zoomOffset = 0.6,   camOffset = 0.65}, --
  {label = _U('chain_2'),               name = 'chain_2',       value = 0,  min = 0,  zoomOffset = 0.6,   camOffset = 0.65, textureof = 'chain_1'}, --
  {label = _U('helmet_1'),              name = 'helmet_1',      value = -1, min = -1, zoomOffset = 0.6,   camOffset = 0.65, componentId = 0 }, --
  {label = _U('helmet_2'),              name = 'helmet_2',      value = 0,  min = 0,  zoomOffset = 0.6,   camOffset = 0.65, textureof = 'helmet_1'}, --
  {label = _U('glasses_1'),             name = 'glasses_1',     value = -1,  min = -1,  zoomOffset = 0.6,   camOffset = 0.65}, --
  {label = _U('glasses_2'),             name = 'glasses_2',     value = 0,  min = 0,  zoomOffset = 0.6,   camOffset = 0.65, textureof = 'glasses_1'}, --
  {label = 'Vänsterarmacessoar',           name = 'watches_1',     value = -1, min = -1, zoomOffset = 0.95,  camOffset = 0.15},
  {label = 'Vänsterarmacessoar färg',      name = 'watches_2',     value = 0,  min = 0,  zoomOffset = 0.95,  camOffset = 0.15, textureof = 'watches_1'},
  {label = 'Högerarmaccessoar',      name = 'bracelets_1',   value = -1, min = -1, zoomOffset = 0.95,  camOffset = 0.15},
  {label = 'Högerarmaccessoar färg',             name = 'bracelets_2',   value = 0,  min = 0,  zoomOffset = 0.95,  camOffset = 0.15, textureof = 'bracelets_1'},
  {label = _U('bag'),                   name = 'bags_1',        value = 0,  min = 0,  zoomOffset = 0.7,  camOffset = 0.15},
  {label = _U('bag_color'),             name = 'bags_2',        value = 0,  min = 0,  zoomOffset = 0.7,  camOffset = 0.15, textureof = 'bags_1'}
}

local LastSex     = -1
local LoadSkin    = nil
local LoadClothes = nil
local Character   = {}

for i=1, #Components, 1 do
  Character[Components[i].name] = Components[i].value
end

GetPedList = function()
	return PedList
end

function LoadDefaultModel(loadMale, cb)

  local playerPed = PlayerPedId()
   local characterModel

  if loadMale then
    characterModel = GetHashKey('mp_m_freemode_01')
  else
    characterModel = GetHashKey('mp_f_freemode_01')
  end

  Citizen.CreateThread(function()

    while not HasModelLoaded(characterModel) do
      RequestModel(characterModel)
      Citizen.Wait(0)
    end

    if IsModelInCdimage(characterModel) and IsModelValid(characterModel) then
      SetPlayerModel(PlayerId(), characterModel)
      SetPedDefaultComponentVariation(playerPed)
    end

    SetModelAsNoLongerNeeded(characterModel)

    if cb ~= nil then
      cb()
    end

    TriggerEvent('skinchanger:modelLoaded')

  end)

end

function GetMaxVals()

  local playerPed = PlayerPedId()

  local data = {
    sex           = #PedList,
    face          = 45,
    skin          = 45,
    age_1         = GetNumHeadOverlayValues(3)-1,
    age_2         = 10,
    beard_1       = GetNumHeadOverlayValues(1)-1,
    beard_2       = 10,
    beard_3       = GetNumHairColors()-1,
    beard_4       = GetNumHairColors()-1,
    hair_1        = GetNumberOfPedDrawableVariations(playerPed, 2) - 1,
    hair_2        = GetNumberOfPedTextureVariations(playerPed, 2, Character['hair_1']) - 1,
    hair_color_1  = GetNumHairColors()-1,
		hair_color_2  = GetNumHairColors()-1,
		eye_color     = 31,
    eyebrows_1    = GetNumHeadOverlayValues(2)-1,
    eyebrows_2    = 10,
    eyebrows_3    = GetNumHairColors()-1,
    eyebrows_4    = GetNumHairColors()-1,
    makeup_1      = GetNumHeadOverlayValues(4)-1,
    makeup_2      = 10,
    makeup_3      = GetNumHairColors()-1,
    makeup_4      = GetNumHairColors()-1,
    lipstick_1    = GetNumHeadOverlayValues(8)-1,
    lipstick_2    = 10,
    lipstick_3    = GetNumHairColors()-1,
    lipstick_4    = GetNumHairColors()-1,
    ears_1        = GetNumberOfPedPropDrawableVariations  (playerPed, 1) - 1,
    ears_2        = GetNumberOfPedPropTextureVariations   (playerPed, 1, Character['ears_1'] - 1),
    tshirt_1      = GetNumberOfPedDrawableVariations      (playerPed, 8) - 1,
    tshirt_2      = GetNumberOfPedTextureVariations       (playerPed, 8, Character['tshirt_1']) - 1,
    torso_1       = GetNumberOfPedDrawableVariations      (playerPed, 11) - 1,
    torso_2       = GetNumberOfPedTextureVariations       (playerPed, 11, Character['torso_1']) - 1,
    decals_1      = GetNumberOfPedDrawableVariations      (playerPed, 10) - 1,
    decals_2      = GetNumberOfPedTextureVariations       (playerPed, 10, Character['decals_1']) - 1,
    arms          = GetNumberOfPedDrawableVariations      (playerPed, 3) - 1,
    pants_1       = GetNumberOfPedDrawableVariations      (playerPed, 4) - 1,
    pants_2       = GetNumberOfPedTextureVariations       (playerPed, 4, Character['pants_1']) - 1,
    shoes_1       = GetNumberOfPedDrawableVariations      (playerPed, 6) - 1,
    shoes_2       = GetNumberOfPedTextureVariations       (playerPed, 6, Character['shoes_1']) - 1,
    mask_1        = GetNumberOfPedDrawableVariations      (playerPed, 1) - 1,
    mask_2        = GetNumberOfPedTextureVariations       (playerPed, 1, Character['mask_1']) - 1,
    bproof_1      = GetNumberOfPedDrawableVariations      (playerPed, 9) - 1,
    bproof_2      = GetNumberOfPedTextureVariations       (playerPed, 9, Character['bproof_1']) - 1,
    chain_1       = GetNumberOfPedDrawableVariations      (playerPed, 7) - 1,
    chain_2       = GetNumberOfPedTextureVariations       (playerPed, 7, Character['chain_1']) - 1,
    bags_1        = GetNumberOfPedDrawableVariations      (playerPed, 5) - 1,
    bags_2        = GetNumberOfPedTextureVariations       (playerPed, 5, Character['bags_1']) - 1,
    helmet_1      = GetNumberOfPedPropDrawableVariations  (playerPed, 0) - 1,
    helmet_2      = GetNumberOfPedPropTextureVariations   (playerPed, 0, Character['helmet_1']) - 1,
    glasses_1     = GetNumberOfPedPropDrawableVariations  (playerPed, 1) - 1,
    glasses_2     = GetNumberOfPedPropTextureVariations   (playerPed, 1, Character['glasses_1'] - 1),
    watches_1     = GetNumberOfPedPropDrawableVariations(playerPed,   6) - 1,
    watches_2     = GetNumberOfPedPropTextureVariations(playerPed,  6, Character['watches_1']) - 1,
    bracelets_1   = GetNumberOfPedPropDrawableVariations(playerPed,   7) - 1,
    bracelets_2   = GetNumberOfPedPropTextureVariations(playerPed,  7, Character['bracelets_1'] - 1),
  }

  return data

end

function ApplySkin(skin, clothes)

  local playerPed = PlayerPedId()

  for k,v in pairs(skin) do
    Character[k] = v
  end

  if clothes ~= nil then

    for k,v in pairs(clothes) do
      if
        k ~= 'sex'          and
        k ~= 'face'         and
        k ~= 'skin'         and
        k ~= 'age_1'        and
        k ~= 'age_2'        and
        k ~= 'beard_1'      and
        k ~= 'beard_2'      and
        k ~= 'beard_3'      and
        k ~= 'beard_4'      and
        k ~= 'hair_1'       and
        k ~= 'hair_2'       and
        k ~= 'hair_color_1' and
        k ~= 'hair_color_2' and
        k ~= 'eyebrows_1'   and
        k ~= 'eyebrows_2'   and
        k ~= 'eyebrows_3'   and
        k ~= 'eyebrows_4'   and
        k ~= 'makeup_1'     and
        k ~= 'makeup_2'     and
        k ~= 'makeup_3'     and
        k ~= 'makeup_4'     and
        k ~= 'lipstick_1'   and
        k ~= 'lipstick_2'   and
        k ~= 'lipstick_3'   and
        k ~= 'lipstick_4'
      then
        Character[k] = v
      end
    end

  end

  SetPedHeadBlendData     (playerPed, Character['face'], Character['face'], Character['face'], Character['skin'], Character['skin'], Character['skin'], 1.0, 1.0, 1.0, true)

  SetPedHairColor         (playerPed,       Character['hair_color_1'],   Character['hair_color_2'])           -- Hair Color
  SetPedHeadOverlay       (playerPed, 3,    Character['age_1'],         (Character['age_2'] / 10) + 0.0)      -- Age + opacity
  SetPedHeadOverlay       (playerPed, 1,    Character['beard_1'],       (Character['beard_2'] / 10) + 0.0)    -- Beard + opacity
  SetPedHeadOverlay       (playerPed, 2,    Character['eyebrows_1'],    (Character['eyebrows_2'] / 10) + 0.0) -- Eyebrows + opacity
  SetPedHeadOverlay       (playerPed, 4,    Character['makeup_1'],      (Character['makeup_2'] / 10) + 0.0)   -- Makeup + opacity
	SetPedHeadOverlay       (playerPed, 8,    Character['lipstick_1'],    (Character['lipstick_2'] / 10) + 0.0) -- Lipstick + opacity
	SetPedEyeColor          (playerPed,       Character['eye_color'], 0, 1)   
  SetPedComponentVariation(playerPed, 2,    Character['hair_1'],         Character['hair_2'], 2)              -- Hair
  SetPedHeadOverlayColor  (playerPed, 1, 1, Character['beard_3'],        Character['beard_4'])                -- Beard Color
  SetPedHeadOverlayColor  (playerPed, 2, 1, Character['eyebrows_3'],     Character['eyebrows_4'])             -- Eyebrows Color
  SetPedHeadOverlayColor  (playerPed, 4, 1, Character['makeup_3'],       Character['makeup_4'])               -- Makeup Color
  SetPedHeadOverlayColor  (playerPed, 8, 1, Character['lipstick_3'],     Character['lipstick_4'])             -- Lipstick Color

  if Character['ears_1'] == -1 then
    ClearPedProp(playerPed, 2)
  else
    SetPedPropIndex(playerPed, 2, Character['ears_1'], Character['ears_2'], 2)  -- Ears Accessories
  end

  SetPedComponentVariation(playerPed, 8,  Character['tshirt_1'],  Character['tshirt_2'], 2)     -- Tshirt
  SetPedComponentVariation(playerPed, 11, Character['torso_1'],   Character['torso_2'], 2)      -- torso parts
  SetPedComponentVariation(playerPed, 3,  Character['arms'], 0, 2)                              -- torso
  SetPedComponentVariation(playerPed, 10, Character['decals_1'],  Character['decals_2'], 2)     -- decals
  SetPedComponentVariation(playerPed, 4,  Character['pants_1'],   Character['pants_2'], 2)      -- pants
  SetPedComponentVariation(playerPed, 6,  Character['shoes_1'],   Character['shoes_2'], 2)      -- shoes
  SetPedComponentVariation(playerPed, 1,  Character['mask_1'],    Character['mask_2'], 2)       -- mask
  SetPedComponentVariation(playerPed, 9,  Character['bproof_1'],  Character['bproof_2'], 2)     -- bulletproof
  SetPedComponentVariation(playerPed, 7,  Character['chain_1'],   Character['chain_2'], 2)      -- chain
  SetPedComponentVariation(playerPed, 5,  Character['bags_1'],    Character['bags_2'], 2)       -- Bag

  if Character['helmet_1'] == -1 then
    ClearPedProp(playerPed, 0)
  else
    SetPedPropIndex(playerPed, 0, Character['helmet_1'], Character['helmet_2'], 2)  -- Helmet
  end

  if Character['watches_1'] == -1 then
    ClearPedProp(playerPed,  6)
  else
    SetPedPropIndex(playerPed, 6, Character['watches_1'], Character['watches_2'], 2)                      -- Watches
  end

  if Character['bracelets_1'] == -1 then
    ClearPedProp(playerPed,  7)
  else
    SetPedPropIndex(playerPed, 7, Character['bracelets_1'], Character['bracelets_2'], 2)                      -- Bracelets
  end

  if Character['glasses_1'] == -1 then
    ClearPedProp(playerPed,  1)
  else
    SetPedPropIndex(playerPed, 1, Character['glasses_1'], Character['glasses_2'], 2)                  -- Glasses
  end

end

AddEventHandler('skinchanger:loadDefaultModel', function(loadMale, cb)
  LoadDefaultModel(loadMale, cb)
end)

AddEventHandler('skinchanger:getData', function(cb)

  local components = json.decode(json.encode(Components))

  for k,v in pairs(Character) do
    for i=1, #components, 1 do
      if k == components[i].name then
        components[i].value = v
        --components[i].zoomOffset = Components[i].zoomOffset
        --components[i].camOffset = Components[i].camOffset
      end
    end
  end

  cb(components, GetMaxVals())
end)

AddEventHandler('skinchanger:change', function(key, val)

  Character[key] = val

  if key == 'sex' then
    TriggerEvent('skinchanger:loadSkin', Character)
  else
    ApplySkin(Character)
  end

end)

AddEventHandler('skinchanger:getSkin', function(cb)
  cb(Character)
end)

AddEventHandler('skinchanger:modelLoaded', function()

  ClearPedProp(PlayerPedId(), 0)

  if LoadSkin ~= nil then

    ApplySkin(LoadSkin)
    LoadSkin = nil

  end

  if LoadClothes ~= nil then

    ApplySkin(LoadClothes.playerSkin, LoadClothes.clothesSkin)
    LoadClothes = nil

  end

end)

RegisterNetEvent('skinchanger:loadSkin')
AddEventHandler('skinchanger:loadSkin', function(skin, cb)

  local playerPed = PlayerPedId()
  local characterModel

  if skin['sex'] ~= LastSex then

    LoadSkin = skin

    if skin['sex'] == 0 then
      TriggerEvent('skinchanger:loadDefaultModel', true, cb)
   	elseif skin['sex'] > 1 then
	    characterModel = PedList[skin.sex + 1]
    else
      TriggerEvent('skinchanger:loadDefaultModel', false, cb)
    end

  RequestModel(characterModel)
      
  else

    ApplySkin(skin)

    if cb ~= nil then
      cb()
    end

  end

  LastSex = skin['sex']
    
  Citizen.CreateThread(function()

    while not HasModelLoaded(characterModel) do
      RequestModel(characterModel)
      Citizen.Wait(0)
    end

    if IsModelInCdimage(characterModel) and IsModelValid(characterModel) then
      SetPlayerModel(PlayerId(), characterModel)
      SetPedDefaultComponentVariation(playerPed)
    end

    SetModelAsNoLongerNeeded(characterModel)
    TriggerEvent('skinchanger:modelLoaded')

  end)

end)

RegisterNetEvent('skinchanger:loadClothes')
AddEventHandler('skinchanger:loadClothes', function(playerSkin, clothesSkin)

  if playerSkin['sex'] ~= LastSex then

    LoadClothes = {
      playerSkin  = playerSkin,
      clothesSkin = clothesSkin
    }

    if playerSkin['sex'] == 0 then
      TriggerEvent('skinchanger:loadDefaultModel', true)
    else
      TriggerEvent('skinchanger:loadDefaultModel', false)
    end

  else
    ApplySkin(playerSkin, clothesSkin)
  end

  LastSex = playerSkin['sex']

end)
