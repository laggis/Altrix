
(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(e,a,n){e.exports=n(22)},17:function(e,a,n){},22:function(e,a,n){"use strict";n.r(a);var t=n(0),s=n.n(t),m=n(1),c=n.n(m),r=(n(17),n(2)),l=n(3),o=n(5),u=n(4),i=n(6),d=n(24),p=function(e){function a(){var e,n;Object(r.a)(this,a);for(var m=arguments.length,c=new Array(m),l=0;l<m;l++)c[l]=arguments[l];return(n=Object(o.a)(this,(e=Object(u.a)(a)).call.apply(e,[this].concat(c)))).state={navigation:{currentIndex:0},lastElement:null,duplicate:!1,width:"300px"},n.renderMenuItems=function(){var e=[],a=n.props.menu.data.elements;return a.forEach(function(m,c){var r=m.label,l=m.type,o=m.value,u="menu-item",i=n.state.navigation.currentIndex,p=100*c;if(c===i&&(u="menu-item selected",i>n.state.lastElement?0===n.state.lastElement&&i===a.length-1?u+=" up":u+=" down":a.length===n.state.lastElement+1?u+=" down":u+=" up"),c===n.state.lastElement&&(i>n.state.lastElement?0===n.state.lastElement&&i===a.length-1?u+=" old up":u+=" old down":a.length===n.state.lastElement+1?u+=" old down":u+=" old up"),"slider"===l){var v=void 0===m.options?o:m.options[o];e.push(s.a.createElement(t.Fragment,{key:c},s.a.createElement(d.a,{timeout:200,appear:!0,in:!0,classNames:"menu-item-anim"},s.a.createElement("div",{id:"".concat(n.props.menu.namespace,"-").concat(n.props.menu.name,"-").concat(c),style:{transitionDelay:"".concat(p,"ms")}},s.a.createElement("div",{className:"".concat(u," slider")},s.a.createElement("div",{className:"menu-status"},s.a.createElement("div",{className:"menu-status-inner"})),s.a.createElement("div",{className:"menu-label"},r,": <",v,">")),s.a.createElement("br",null)))))}else e.push(s.a.createElement(t.Fragment,{key:c},s.a.createElement(d.a,{timeout:200,appear:!0,in:!0,classNames:"menu-item-anim"},s.a.createElement("div",{id:"".concat(n.props.menu.namespace,"-").concat(n.props.menu.name,"-").concat(c),style:{transitionDelay:"".concat(p,"ms")}},s.a.createElement("div",{className:u},s.a.createElement("div",{className:"menu-status"},s.a.createElement("div",{className:"menu-status-inner"})),s.a.createElement("div",{className:"menu-label"},r)),s.a.createElement("br",null)))))}),e},n.handleMessage=function(e){if(e.data){var a=e.data;switch(a.action){case"controlPressed":n.navigate(a.control,a.shift)}}},n.handleKeyUp=function(e){if(n.props.menu.focus)switch(e.keyCode){case 38:n.navigate("UP");break;case 40:n.navigate("DOWN");break;case 37:n.navigate("LEFT");break;case 39:n.navigate("RIGHT");break;case 8:n.navigate("BACKSPACE")}},n.navigate=function(e,a){var t=n.state.navigation.currentIndex,s=n.props.menu.data.elements,m=s[t],c=n.state.navigation;if(n.props.menu.focus){var r=n.props.menu;switch(e){case"DOWN":n.setState({lastElement:t}),s[t+1]?(c.currentIndex++,n.setState({navigation:c}),document.getElementById("".concat(n.props.menu.namespace,"-").concat(n.props.menu.name,"-").concat(t+1)).scrollIntoViewIfNeeded()):(c.currentIndex=0,n.setState({navigation:c}),document.getElementById("".concat(n.props.menu.namespace,"-").concat(n.props.menu.name,"-").concat(c.currentIndex)).scrollIntoViewIfNeeded());for(var l=0;l<r.data.elements.length;l++){var o=r.data.elements[l];l===t&&(o.selected=!0)}n.props.onData({type:"menuChange",data:{namespace:n.props.menu.namespace,name:n.props.menu.name,currentElement:s[c.currentIndex],elements:r.data.elements}});break;case"UP":n.setState({lastElement:t}),s[t-1]?(c.currentIndex--,n.setState({navigation:c}),document.getElementById("".concat(n.props.menu.namespace,"-").concat(n.props.menu.name,"-").concat(t-1)).scrollIntoViewIfNeeded()):(c.currentIndex=s.length-1,n.setState({navigation:c}),document.getElementById("".concat(n.props.menu.namespace,"-").concat(n.props.menu.name,"-").concat(c.currentIndex)).scrollIntoViewIfNeeded());for(var u=0;u<r.data.elements.length;u++){var i=r.data.elements[u];u===t&&(i.selected=!0)}n.props.onData({type:"menuChange",data:{namespace:n.props.menu.namespace,name:n.props.menu.name,currentElement:s[c.currentIndex],elements:r.data.elements}});break;case"LEFT":if("slider"===m.type){var d=m.min?m.min:0;if(d!==m.value){var p=n.props.menu;a?m.value-10<d?m.value=d:p.data.elements[t].value-=10:p.data.elements[t].value--,n.props.onData({type:"sliderValueChange",data:{menu:p,currentElement:m}})}}break;case"RIGHT":if("slider"===m.type&&m.max!==m.value){var v=n.props.menu;a?m.value+10>m.max?m.value=m.max:v.data.elements[t].value+=10:v.data.elements[t].value++,n.props.onData({type:"sliderValueChange",data:{menu:v,currentElement:m}})}break;case"BACKSPACE":n.props.onData({type:"menuCancel",data:{namespace:n.props.menu.namespace,name:n.props.menu.name}});break;case"ENTER":n.props.onData({type:"menuSubmit",data:{namespace:n.props.menu.namespace,name:n.props.menu.name,currentElement:m,elements:n.props.menu.data.elements}})}}},n}return Object(i.a)(a,e),Object(l.a)(a,[{key:"render",value:function(){var e=this.props.menu.data,a=e.align,n=e.title,t="menu align-".concat(a);return t+=this.props.menu.focus?"":" hidden",s.a.createElement("div",{id:"".concat(this.props.menu.namespace,"-").concat(this.props.menu.name,"-menu"),className:t},s.a.createElement("div",{className:"head"},s.a.createElement("div",{className:"head-line"}),s.a.createElement("p",null,n),s.a.createElement("div",{className:"head-line head-line-last"})),s.a.createElement("div",{className:"menu-items"},this.renderMenuItems()))}},{key:"componentDidMount",value:function(){window.addEventListener("keyup",this.handleKeyUp),window.addEventListener("message",this.handleMessage);var e=this.props.menu.data.elements,a=[];e.forEach(function(e,n){var t=e.label;t.length>43&&a.push(t.length)});var n=Math.max.apply(Math,a)||"300";document.getElementById("".concat(this.props.menu.namespace,"-").concat(this.props.menu.name,"-menu")).style.width=8.6*n+"px"}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keyup",this.handleKeyUp),window.removeEventListener("message",this.handleMessage)}},{key:"shouldComponentUpdate",value:function(e,a){return a.lastElement===this.state.lastElement}}]),a}(t.Component),v=function(e){function a(e){var n;return Object(r.a)(this,a),(n=Object(o.a)(this,Object(u.a)(a).call(this,e))).renderMenus=function(){var e=n.state.menus,a=[];return e.forEach(function(t,m){m===e.length-1?t.focus=!0:t.focus=!1,a.push(s.a.createElement(p,{onData:function(e){return n.handleOnData(e)},key:m,menu:t}))}),a},n.openMenu=function(e,a,t){for(var s=n.state.menus,m={},c=0;c<s.length;c++)s[c].focus=!1;for(var r=0;r<s.length;r++){var l=s[r];if(l.namespace===e&&l.name===a)return l.data=t,l.focus=!0,void n.setState({menus:s})}for(var o=0;o<t.elements.length;o++)t.elements[o].selected&&(t.elements[o].selected=!1),void 0===t.elements[o].type&&(t.elements[o].type="default");t.elements[0]&&(t.elements[0].selected=!0),m.name=a,m.namespace=e,m.data=t,s.push(m),n.setState({menus:s})},n.handleMessage=function(e){var a=e.data,t=a.namespace,s=a.name,m=a.data;if(e.data)switch(e.data.action){case"openMenu":n.openMenu(t,s,m);break;case"closeMenu":n.closeMenu(s,t)}},n.closeMenu=function(e,a){for(var t=n.state.menus,s=0;s<t.length;s++)t[s].name===e&&t[s].namespace===a&&(t.splice(s,1),n.setState({menus:t}))},n.emitClientEvent=function(e,a){var n={method:"POST",body:JSON.stringify(a)};fetch("http://altrix_menu/".concat(e),n)},n.handleOnData=function(e){switch(e.type){case"sliderValueChange":for(var a=n.state.menus,t=0;t<a.length;t++){var s=a[t];if(s.namespace===e.data.menu.namespace&&s.name===e.data.menu.name){a[t]=e.data.menu;break}}n.setState({menus:a},function(){n.emitClientEvent("menu_change",{_namespace:e.data.menu.namespace,_name:e.data.menu.name,current:e.data.currentElement,elements:e.data.menu.data.elements})});break;case"menuChange":n.emitClientEvent("menu_change",{_namespace:e.data.namespace,_name:e.data.name,current:e.data.currentElement,elements:e.data.elements});break;case"menuCancel":n.emitClientEvent("menu_cancel",{_namespace:e.data.namespace,_name:e.data.name});break;case"menuSubmit":n.emitClientEvent("menu_submit",{_namespace:e.data.namespace,_name:e.data.name,current:e.data.currentElement,elements:e.data.elements})}},n.state={menus:[]},n}return Object(i.a)(a,e),Object(l.a)(a,[{key:"render",value:function(){return s.a.createElement("div",{className:"menus"},this.renderMenus())}},{key:"componentDidMount",value:function(){window.addEventListener("message",this.handleMessage)}}]),a}(t.Component);var h=function(){return s.a.createElement("div",{className:"App"},s.a.createElement(v,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(s.a.createElement(h,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[12,1,2]]]);
//# sourceMappingURL=main.b02dda68.chunk.js.map